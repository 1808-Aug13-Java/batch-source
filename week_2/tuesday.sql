/*
Create a table INVOICE which includes an id, date, customer id, and amount
Create a table CUSTOMER which includes relevant customer information 
Customer id in the invoice table should make a reference to the customer id in the customer table
Insert at least 50 records into your invoice table and at least 10 records into your customer table
Create a query which shows purchases that occured today
Create a query which shows each customer and the number of purchases made by each
Create a query which shows each customer and the total cost of all their purchases
Create a query which returns all purchases which took place in the last month, display them in descending order
Create a query which show the top three most expensive purchases
*/

CREATE TABLE CUSTOMER (
    CUSTOMER_ID NUMBER(5) PRIMARY KEY,
    CUSTOMER_NAME VARCHAR2(25),
    STREET VARCHAR2(25),
    CITY VARCHAR2(25),
    CUSTOMER_STATE VARCHAR2(2),
    ZIPCODE NUMBER(5),
    EMAIL VARCHAR2(30)
);


CREATE TABLE INVOICE (
    INVOICE_ID NUMBER(5) PRIMARY KEY,
    CUSTOMER_ID NUMBER(5),
    INVOICE_DATE DATE,
    INVOICE_AMOUNT NUMBER(7, 2)
);


-- ADD PK
ALTER TABLE INVOICE
ADD CONSTRAINT FK_CUSTOMER
FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER;

INSERT INTO CUSTOMER VALUES (1, 'JOHN DOE', '1 MAIN ST', 'RESTON', 'VA', 20190, 'jdoe@revature.com');
INSERT INTO CUSTOMER VALUES (2, 'JANE DOE', '37 STERLING AVE', 'BIRMINGHAM', 'AL', 12345, 'ebarthod3@purevolume.com');
INSERT INTO CUSTOMER VALUES (3, 'JAKE SMITH', '2000 COLUMBIA RD', 'MOBILE', 'AL', 09876, 'jdunphy7@simplemachines.org');
INSERT INTO CUSTOMER VALUES (4, 'GEORGE WASHINGTON', '10 WEST RD', 'SEATTLE', 'WA', 54321, 'smatskiv9@xrea.com');
INSERT INTO CUSTOMER VALUES (5, 'BRAD PITT', '1337 EAST RD', 'RESTON', 'VA', 11111, 'hvondra8@scribd.com');
INSERT INTO CUSTOMER VALUES (6, 'ALEX BUMPERS', '800 NORTH ST', 'SEATTLE', 'WA', 12344, 'ggilbee0@nytimes.com');
INSERT INTO CUSTOMER VALUES (7, 'JOHN MUIR', '9 DULLES BLVD', 'BILOXI', 'MS', 08578, 'aramard5@wikimedia.org');
INSERT INTO CUSTOMER VALUES (8, 'EDGAR POE', '999 BROOKLYN AVE', 'NEW YORK', 'NY', 15432, 'testing@test.com');
INSERT INTO CUSTOMER VALUES (9, 'ABE LINCOLN', '2 RESTON ST', 'RESTON', 'VA', 10998, 'john@example.com');
INSERT INTO CUSTOMER VALUES (10, 'PETER PARKER', '1738 WISCONSIN BLVD', 'NEW ORLEANS', 'LA', 36678, 'jeff@amazon.com');

INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (1, 1, DATE '2018-06-17', 5795.02);


-- ALL INVOICE INSERTS --
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (50, 10, DATE '2018-05-11', 4401.63);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (2, 2, DATE'2018-07-18', 1032.5);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (3, 1, DATE '2018-04-29', 4189.73);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (4, 1, DATE '2018-06-10', 1598.8);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (5, 5, DATE '2018-01-27', 2084.73);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (6, 1, DATE '2017-12-17', 5987.72);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (7, 3, DATE '2017-11-10', 2127.8);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (8, 2, DATE '2018-06-25', 5125.6);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (9, 8, DATE '2017-12-03', 4296.79);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (10, 4, DATE '2018-01-16', 8081.25);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (11, 1, DATE '2018-02-25', 6847.89);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (12, 9, DATE '2018-05-25', 3442.73);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (13, 10, DATE '2018-06-04', 910.61);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (14, 10, DATE '2018-04-13', 8975.59);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (15, 3, DATE '2017-10-16', 1615.53);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (16, 9, DATE '2018-05-24', 9545.76);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (17, 3, DATE '2018-08-01', 8470.68);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (18, 3, DATE '2018-05-22', 8275.42);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (19, 10, DATE '2017-10-29', 8877.21);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (20, 4, DATE '2017-09-12', 4505.99);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (21, 3, DATE '2018-08-15', 9285.02);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (22, 6, DATE '2017-09-02', 5992.06);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (23, 6, DATE '2018-02-28', 4937.03);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (24, 3, DATE '2018-05-26', 9913.41);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (25, 4, DATE '2018-02-17', 5884.05);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (26, 1, DATE '2017-08-26', 3325.11);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (27, 3, DATE '2018-07-17', 2467.47);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (28, 10, DATE '2018-04-06', 2646.95);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (29, 9, DATE '2018-04-18', 4709.73);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (30, 3, DATE '2018-08-07', 7400.62);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (31, 3, DATE '2017-11-19', 5280.82);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (32, 4, DATE '2017-12-12', 7742.94);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (33, 9, DATE '2018-05-07', 532.65);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (34, 6, DATE '2017-12-13', 5127.46);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (35, 5, DATE '2018-04-01', 9258.94);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (36, 6, DATE '2018-01-21', 8957.89);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (37, 1, DATE '2017-12-28', 9726.13);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (38, 10, DATE '2017-10-22', 8235.29);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (39, 6, DATE '2018-02-28', 363.47);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (40, 1, DATE '2017-12-04', 2875.46);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (41, 10, DATE '2018-06-13', 1003.54);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (42, 2, DATE '2018-02-06', 7928.83);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (43, 10, DATE '2018-08-08', 3685.46);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (44, 3, DATE '2017-12-30', 2058.29);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (45, 4, DATE '2018-01-01', 7981.52);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (46, 6, DATE '2018-04-24', 221.02);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (47, 9, DATE '2018-03-04', 9956.92);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (48, 6, DATE '2018-01-23', 1774.29);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (49, 4, DATE '2017-09-14', 9982.42);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (51, 4, DATE '2018-08-21', 9982.42);
INSERT INTO INVOICE (INVOICE_ID, CUSTOMER_ID, INVOICE_DATE, INVOICE_AMOUNT) values (52, 7, DATE '2018-08-21', 9000.42);


-- TOP 3 PURCHASES W/ ALL TABLE INFO
-- Create a query which show the top three most expensive purchases
SELECT *
FROM (INVOICE)
WHERE ROWNUM < 4
ORDER BY INVOICE_AMOUNT DESC;

-- HERE'S THE TOP 3 IF YOU JUST WANT THE INVOICE AMOUNT AND NO OTHER INFO
SELECT INVOICE_AMOUNT
FROM (INVOICE)
WHERE ROWNUM < 4
ORDER BY INVOICE_AMOUNT DESC;

-- Create a query which shows purchases that occured today
SELECT *
FROM INVOICE
WHERE INVOICE_DATE= DATE '2018-08-21';

-- Create a query which shows each customer and the number of purchases made by each
SELECT CUSTOMER_ID, COUNT (INVOICE_ID)
FROM INVOICE
GROUP BY CUSTOMER_ID
ORDER BY COUNT (INVOICE_ID) DESC;

-- Create a query which shows each customer and the total cost of all their purchases
SELECT CUSTOMER_ID, SUM(INVOICE_AMOUNT)
FROM INVOICE
GROUP BY CUSTOMER_ID
ORDER BY SUM (INVOICE_AMOUNT) DESC;

-- Create a query which returns all purchases which took place in the last month, display them in descending order
SELECT *
FROM INVOICE
WHERE INVOICE_DATE >= ADD_MONTHS(SYSDATE, -1);

