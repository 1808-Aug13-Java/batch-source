--------------------------------------------
-- August 21st Assignment
--------------------------------------------
CREATE TABLE INVOICE (
    INVOICE_ID NUMBER(5) CONSTRAINT PK_INVOICE PRIMARY KEY,
    PURCHASE_DATE DATE, 
    CUSTOMER_ID NUMBER(5) CONSTRAINT FK_CUST_INVOICE REFERENCES CUSTOMER,
    AMOUNT NUMBER (7, 2)
);

CREATE TABLE CUSTOMER (
    CUST_NAME VARCHAR2(50),
    CUSTOMER_ID NUMBER(5) CONSTRAINT PK_CUST PRIMARY KEY,
    PAYMENT_METHOD VARCHAR2(25),
    STREET VARCHAR2(75),
    CITY VARCHAR2(50),
    STATE VARCHAR2(2),
    ZIP NUMBER(5)
);



INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (1, DATE '2018-06-28', 3, 8518.57);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (2, DATE '2018-08-02', 9, 79.63);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (3, DATE '2017-10-29', 8, 5416.92);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (4, DATE '2018-06-04', 7, 9421.85);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (5, DATE '2018-08-21', 6, 8123.55);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (6, DATE '2018-01-02', 5, 6904.41);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (7, DATE '2017-10-26', 1, 975.77);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (8, DATE '2017-08-26', 2, 1923.01);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (9, DATE '2017-12-22', 7, 5714.78);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (10, DATE '2017-11-16', 6, 6174.17);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (11, DATE '2018-03-07', 6, 3462.16);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (12, DATE '2017-09-07', 6, 982.64);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (13, DATE '2017-12-07', 5, 618.41);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (14, DATE '2018-07-21', 5, 1676.71);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (15, DATE '2017-09-28', 10, 5317.91);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (16, DATE '2017-09-21', 6, 4634.31);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (17, DATE '2018-01-12', 8, 476.73);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (18, DATE '2018-02-17', 9, 8661.82);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (19, DATE '2018-06-10', 9, 888.43);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (20, DATE '2017-12-19', 9, 1928.19);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (21, DATE '2017-09-07', 9, 4248.32);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (22, DATE '2018-05-21', 6, 3027.57);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (23, DATE '2017-09-30', 5, 4640.41);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (24, DATE '2017-09-24', 3, 3295.07);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (25, DATE '2017-10-24', 1, 1696.28);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (26, DATE '2018-01-09', 2, 5643.8);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (27, DATE '2018-04-21', 6, 1390.85);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (28, DATE '2018-05-26', 5, 7683.72);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (29, DATE '2018-03-21', 10, 7157.79);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (30, DATE '2018-01-08', 10, 4670.11);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (31, DATE '2018-04-25', 7, 8780.65);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (32, DATE '2017-10-23', 4, 3685.84);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (33, DATE '2018-06-27', 4, 8546.15);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (34, DATE '2018-08-01', 8, 4523.17);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (35, DATE '2017-11-21', 7, 8831.64);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (36, DATE '2018-07-05', 7, 4284.06);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (37, DATE '2017-08-27', 9, 1793.3);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (38, DATE '2018-04-22', 9, 6100.45);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (39, DATE '2018-05-29', 6, 2306.92);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (40, DATE '2018-01-10', 5, 7164.0);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (41, DATE '2018-05-05', 3, 7004.99);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (42, DATE '2018-04-02', 1, 5542.77);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (43, DATE '2018-05-31', 2, 9916.69);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (44, DATE '2018-05-08', 9, 3623.82);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (45, DATE '2017-12-10', 9, 6426.68);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (46, DATE '2017-09-01', 10, 7191.81);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (47, DATE '2018-01-04', 9, 7593.18);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (48, DATE '2018-06-10', 9, 9735.23);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (49, DATE '2017-10-24', 2, 2474.04);
INSERT INTO INVOICE (INVOICE_ID, PURCHASE_DATE, CUSTOMER_ID, AMOUNT) values (50, DATE '2017-12-20', 2, 8053.74);

INSERT INTO CUSTOMER (CUST_NAME, CUSTOMER_ID, PAYMENT_METHOD, STREET, CITY, STATE, ZIP) values ('El Schistl', 9, '4041591819968620', '22 Randy Hill', 'Montgomery', 'A', '36104');
INSERT INTO CUSTOMER (CUST_NAME, CUSTOMER_ID, PAYMENT_METHOD, STREET, CITY, STATE, ZIP) values ('Othilia Eddoes', 2, '4041378232615', '8385 Lakewood Point', 'Jacksonville', 'FL', '32215');
INSERT INTO CUSTOMER (CUST_NAME, CUSTOMER_ID, PAYMENT_METHOD, STREET, CITY, STATE, ZIP) values ('Tatiania Dacre', 3, '3562891273211546', '90 Barby Lane', 'Madison', 'WI', '53790');
INSERT INTO CUSTOMER (CUST_NAME, CUSTOMER_ID, PAYMENT_METHOD, STREET, CITY, STATE, ZIP) values ('Spenser Waplington', 4, '3584956848460870', '1 Kinsman Circle', 'Minneapolis', 'MN', '55417');
INSERT INTO CUSTOMER (CUST_NAME, CUSTOMER_ID, PAYMENT_METHOD, STREET, CITY, STATE, ZIP) values ('Iver Sheppard', 1, '4844625149047108', '27 School Junction', 'Lexington', 'KY', '40524');
INSERT INTO CUSTOMER (CUST_NAME, CUSTOMER_ID, PAYMENT_METHOD, STREET, CITY, STATE, ZIP) values ('Scottie Sherland', 7, '3576160355126301', '842 Shelley Parkway', 'Baton Rouge', 'LA', '70894');
INSERT INTO CUSTOMER (CUST_NAME, CUSTOMER_ID, PAYMENT_METHOD, STREET, CITY, STATE, ZIP) values ('Marchelle Egentan', 8, '5602245336106432', '860 Towne Place', 'Detroit', 'MI', '48211');
INSERT INTO CUSTOMER (CUST_NAME, CUSTOMER_ID, PAYMENT_METHOD, STREET, CITY, STATE, ZIP) values ('Peggy McKeefry', 10, '5610376647250880', '63555 Mcbride Park', 'Salt Lake City', 'UT', '84115');
INSERT INTO CUSTOMER (CUST_NAME, CUSTOMER_ID, PAYMENT_METHOD, STREET, CITY, STATE, ZIP) values ('Ingrim Allibon', 5, '3586837188194972', '81 Arkansas Center', 'Charlottesville', 'VA', '22908');
INSERT INTO CUSTOMER (CUST_NAME, CUSTOMER_ID, PAYMENT_METHOD, STREET, CITY, STATE, ZIP) values ('Halsey Pomphrett', 6, '3574969645656675', '143 South Hill', 'Tucson', 'AZ', '85732');


SELECT *
FROM INVOICE
WHERE PURCHASE_DATE = DATE '2018-08-21';

SELECT cust.CUST_NAME, COUNT(trans.CUSTOMER_ID) AS TOTAL_PURCHASES
FROM CUSTOMER cust, INVOICE trans
WHERE cust.CUSTOMER_ID = trans.CUSTOMER_ID
GROUP BY CUST_NAME;

SELECT cust.CUST_NAME, SUM(trans.AMOUNT) AS TOTAL_SPENT
FROM CUSTOMER cust, INVOICE trans
WHERE cust.CUSTOMER_ID = trans.CUSTOMER_ID
GROUP BY CUST_NAME;

SELECT *
FROM (SELECT * FROM INVOICE
ORDER BY PURCHASE_DATE)
WHERE PURCHASE_DATE >= DATE '2018-07-21';

SELECT *
FROM (SELECT * FROM INVOICE
ORDER BY AMOUNT DESC)
WHERE ROWNUM <= 3;

-------------------------------------------------
-- August 22nd Assignment
-------------------------------------------------
--PART A
SELECT *
FROM INVOICE
JOIN CUSTOMER
ON INVOICE.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID;
--PART B
SELECT *
FROM CUSTOMER
LEFT JOIN INVOICE
ON INVOICE.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID;
--PART C
SELECT
    C.CUST_NAME AS NAME,
    I.*
FROM INVOICE I
JOIN CUSTOMER C
ON I.CUSTOMER_ID = C.CUSTOMER_ID;
--PART D
SELECT cust.CUST_NAME, SUM(trans.AMOUNT) AS TOTAL_SPENT
FROM CUSTOMER cust, INVOICE trans
WHERE cust.CUSTOMER_ID = trans.CUSTOMER_ID
GROUP BY CUST_NAME;
--PART E
SELECT 
    C.*
FROM CUSTOMER C, (SELECT * FROM INVOICE
ORDER BY PURCHASE_DATE DESC)
WHERE ROWNUM = 1;
--PART F
SELECT
    C.CUST_NAME,
    I.AMOUNT,
    ROUND((I.AMOUNT/1.06),2) AS SUBTOTAL
FROM CUSTOMER C, INVOICE I;
