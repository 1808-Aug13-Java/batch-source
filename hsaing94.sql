CREATE TABLE INVOICE (
    INVOICE_ID NUMBER(5) CONSTRAINT PK_INVOICE PRIMARY KEY,
    INVOICE_DATE DATE,
    CUSTOMER_ID NUMBER(5) CONSTRAINT FK_CUST REFERENCES CUSTOMER,
    AMOUNT NUMBER(5,2)
    );
    
CREATE TABLE CUSTOMER (
    CUSTOMER_ID NUMBER(5) CONSTRAINT PK_CUST PRIMARY KEY,
    CUSTOMER_NAME VARCHAR2(50)
);

INSERT INTO CUSTOMER VALUES(1, 'HENRY SAING');
INSERT INTO CUSTOMER VALUES(2, 'JAMES BOND');
INSERT INTO CUSTOMER VALUES(3, 'ALEX HUERTA');
INSERT INTO CUSTOMER VALUES(4, 'CARL SOTELLO');
INSERT INTO CUSTOMER VALUES(5, 'JIM SMITH');
INSERT INTO CUSTOMER VALUES(6, 'JANE DOE');
INSERT INTO CUSTOMER VALUES(7, 'HARRY HOUDINI');
INSERT INTO CUSTOMER VALUES(8, 'BRUCE WAYNE');
INSERT INTO CUSTOMER VALUES(9, 'CLARK KENT');
INSERT INTO CUSTOMER VALUES(10, 'PETER PARKER');


INSERT INTO INVOICE VALUES (1, DATE '2018-08-04', 10, 49.35);
INSERT INTO INVOICE VALUES (2, DATE '2018-07-16', 5, 96.22);
INSERT INTO INVOICE VALUES (3, DATE '2018-08-10', 9, 91.66);
INSERT INTO INVOICE VALUES (4, DATE '2018-06-30', 2, 90.08);
INSERT INTO INVOICE VALUES (5, DATE '2018-07-06', 5, 67.31);
INSERT INTO INVOICE VALUES (6, DATE '2018-07-26', 5, 50.57);
INSERT INTO INVOICE VALUES (7, DATE '2018-07-29', 7, 91.89);
INSERT INTO INVOICE VALUES (8, DATE '2018-07-02', 10, 24.83);
INSERT INTO INVOICE VALUES (9, DATE '2018-06-29', 7, 4.35);
INSERT INTO INVOICE VALUES (10, DATE '2018-07-13', 6, 71.1);
INSERT INTO INVOICE VALUES (11, DATE '2018-07-29', 6, 65.82);
INSERT INTO INVOICE VALUES (12, DATE '2018-07-04', 9, 77.91);
INSERT INTO INVOICE VALUES (13, DATE '2018-07-16', 7, 67.37);
INSERT INTO INVOICE VALUES (14, DATE '2018-06-30', 6, 53.56);
INSERT INTO INVOICE VALUES (15, DATE '2018-07-27', 4, 38.45);
INSERT INTO INVOICE VALUES (16, DATE '2018-08-17', 5, 42.41);
INSERT INTO INVOICE VALUES (17, DATE '2018-08-19', 8, 41.41);
INSERT INTO INVOICE VALUES (18, DATE '2018-07-17', 8, 98.08);
INSERT INTO INVOICE VALUES (19, DATE '2018-06-23', 1, 10.92);
INSERT INTO INVOICE VALUES (20, DATE '2018-08-20', 3, 1.15);
INSERT INTO INVOICE VALUES (21, DATE '2018-07-20', 7, 9.63);
INSERT INTO INVOICE VALUES (22, DATE '2018-08-16', 1, 23.95);
INSERT INTO INVOICE VALUES (23, DATE '2018-06-24', 5, 51.63);
INSERT INTO INVOICE VALUES (24, DATE '2018-07-12', 9, 24.3);
INSERT INTO INVOICE VALUES (25, DATE '2018-08-01', 6, 50.08);
INSERT INTO INVOICE VALUES (26, DATE '2018-06-30', 7, 38.85);
INSERT INTO INVOICE VALUES (27, DATE '2018-07-25', 7, 26.04);
INSERT INTO INVOICE VALUES (28, DATE '2018-07-14', 8, 77.42);
INSERT INTO INVOICE VALUES (29, DATE '2018-06-26', 1, 22.75);
INSERT INTO INVOICE VALUES (30, DATE '2018-06-29', 8, 5.25);
INSERT INTO INVOICE VALUES (31, DATE '2018-08-18', 4, 71.66);
INSERT INTO INVOICE VALUES (32, DATE '2018-07-15', 9, 63.47);
INSERT INTO INVOICE VALUES (33, DATE '2018-07-18', 10, 30.93);
INSERT INTO INVOICE VALUES (34, DATE '2018-06-21', 10, 64.04);
INSERT INTO INVOICE VALUES (35, DATE '2018-07-31', 7, 17.12);
INSERT INTO INVOICE VALUES (36, DATE '2018-06-29', 9, 93.86);
INSERT INTO INVOICE VALUES (37, DATE '2018-07-02', 3, 71.0);
INSERT INTO INVOICE VALUES (38, DATE '2018-07-18', 5, 90.53);
INSERT INTO INVOICE VALUES (39, DATE '2018-06-30', 5, 1.62);
INSERT INTO INVOICE VALUES (40, DATE '2018-07-07', 6, 4.22);
INSERT INTO INVOICE VALUES (41, DATE '2018-08-17', 4, 79.49);
INSERT INTO INVOICE VALUES (42, DATE '2018-08-12', 7, 45.12);
INSERT INTO INVOICE VALUES (43, DATE '2018-07-25', 3, 25.35);
INSERT INTO INVOICE VALUES (44, DATE '2018-07-01', 8, 74.44);
-- TEST
INSERT INTO INVOICE VALUES (45, DATE '2018-08-21', 6, 2.79);
INSERT INTO INVOICE VALUES (46, DATE '2018-06-25', 5, 43.31);
INSERT INTO INVOICE VALUES (47, DATE '2018-07-03', 4, 61.66);
INSERT INTO INVOICE VALUES (48, DATE '2018-07-19', 5, 92.05);
INSERT INTO INVOICE VALUES (49, DATE '2018-07-20', 9, 41.08);
INSERT INTO INVOICE VALUES (50, DATE '2018-07-02', 4, 82.41);


-- TUESDAY QUERY 1
SELECT *
FROM INVOICE
WHERE invoice_date = DATE '2018-08-21';
-- THE WAY THE RANDOM DATA WAS CREATED, NO INVOICE WAS HAD FOR TODAY'S DATE, SO I JUST LOOKED UP ANOTHER DAY


-- TUESDAY QUERY 2
SELECT CUSTOMER_ID , COUNT (INVOICE_ID) AS NUMPURCHASE
FROM INVOICE
GROUP BY CUSTOMER_ID;


--TUESDAY QUERY 3
SELECT SUM (AMOUNT)
FROM INVOICE
GROUP BY CUSTOMER_ID;


--TUESDAY QUERY 4
SELECT INVOICE_ID, INVOICE_DATE
FROM INVOICE
WHERE INVOICE_DATE < ADD_MONTHS (SYSDATE,-1);


--TUESDAY QUERY 5
SELECT * FROM (
SELECT *
FROM INVOICE
ORDER BY AMOUNT DESC)
WHERE ROWNUM <=3;


--DAY 2 ASSIGNMENT
/* I DID THIS TO MAKE A DATA SET AVAILABLE TO REVEAL RELEVANT DATA
    THE RANDOMLY GENERATED DATA BEFORE DID NOW HAVE ANY INVOICES WITH NO CUSTOMER OR VICE VERSA
    THERE IS NOW INVOICES WITH NO CUSTOMER AND CUSTOMER 10 HAS NO INVOICES
*/
UPDATE INVOICE
SET CUSTOMER_ID = NULL
WHERE CUSTOMER_ID = 10;

-- WEDNESDAY QUESTION A START
SELECT *
FROM INVOICE
MINUS
SELECT *
FROM INVOICE
WHERE CUSTOMER_ID IS NULL;
-- WEDNESDAY QUESTION A END


-- WEDNESDAY QUESTION B START
SELECT INVOICE_ID, INVOICE_DATE, AMOUNT, CUSTOMER_NAME
FROM INVOICE I
RIGHT JOIN CUSTOMER C
ON I.CUSTOMER_ID = C.CUSTOMER_ID;
-- WEDNESDAY QUESTION B END

-- WEDNESDAY QUESTION C START
SELECT *
FROM INVOICE I
LEFT JOIN CUSTOMER C
ON I.CUSTOMER_ID = C.CUSTOMER_ID;
-- WEDNESDAY QUESTION C END

--WEDNESDAY QUESTION D START
SELECT C.CUSTOMER_NAME, SUM(I.AMOUNT)
FROM CUSTOMER C
LEFT JOIN INVOICE I
ON C.CUSTOMER_ID = I.CUSTOMER_ID
GROUP BY c.customer_name;
--WEDNESDAY QUESTION D END


--WEDNESDAY QUESTION E START
SELECT * FROM(
SELECT C.CUSTOMER_NAME, I.INVOICE_ID, I.INVOICE_DATE, I.AMOUNT
FROM CUSTOMER C
RIGHT JOIN INVOICE I
ON C.CUSTOMER_ID = I.CUSTOMER_ID
ORDER BY I.INVOICE_DATE DESC)
WHERE ROWNUM <=1;
--WEDNESDAY QUESTION E END


--WEDNESDAY QUESTION F START
SELECT  C.CUSTOMER_NAME, I.INVOICE_ID, I.INVOICE_DATE, I.AMOUNT, AMOUNT*(1.06) AS "PRICE AFTER TAX"
FROM INVOICE I
LEFT JOIN CUSTOMER C
ON I.CUSTOMER_ID = C.CUSTOMER_ID;
--WEDNESDAY QUESTION F END



--WEDNESDAY QUESTION F END