CREATE TABLE CUSTOMER (
CUSTOMER_ID NUMBER(5) PRIMARY KEY,
CUSTOMER_NAME VARCHAR2(35),
CUSTOMER_PHONE CHAR(10)
);

CREATE TABLE INVOICE(
INVOICE_ID NUMBER(5) PRIMARY KEY,
INVOICE_DATE DATE,
CUSTOMER_ID NUMBER(5) CONSTRAINT FK_CUST_ID REFERENCES CUSTOMER,
AMOUNT NUMBER(7,2)
);
insert into CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_PHONE) values (1, 'Kaitlyn Worthing', '8568478666');
insert into CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_PHONE) values (2, 'Cyndy McAless', '45071CUSTOMER_ID55105');
insert into CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_PHONE) values (3, 'Donalt Surgenor', '8006841154');
insert into CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_PHONE) values (4, 'Nata Bruckental', '3015967016');
insert into CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_PHONE) values (5, 'Elston Roaf', '9254522817');
insert into CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_PHONE) values (6, 'See Dumini', '8312367345');
insert into CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_PHONE) values (7, 'Carolee O''Corr', '9688112119');
insert into CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_PHONE) values (8, 'Englebert McEvay', '6824768532');
insert into CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_PHONE) values (9, 'Joana Konig', '8361589036');
insert into CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_PHONE) values (10, 'Morley Curwen', '5148753664');

insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (1, DATE '2017-11-04', 7, 1716.38);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (2, DATE '2018-01-04', 9, 20704.99);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (3, DATE '2017-12-23', 8, 80135.22);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (4, DATE '2018-08-08', 9, 67643.58);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (5, DATE '2017-09-30', 8, 50619.85);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (6, DATE '2018-05-24', 8, 86100.15);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (7, DATE '2018-03-18', 3, 28789.27);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (8, DATE '2018-07-11', 9, 78586.82);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (9, DATE '2017-12-14', 10, 38838.56);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (10, DATE '2017-10-19', 6, 71251.47);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (11, DATE '2018-05-04', 6, 67277.13);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (12, DATE '2017-09-08', 6, 13836.04);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (13, DATE '2017-08-23', 8, 49072.09);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (14, DATE '2018-04-12', 7, 50054.69);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (15, DATE '2018-02-05', 5, 65981.52);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (16, DATE '2018-06-28', 10, 6884.14);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (17, DATE '2017-10-26', 5, 8606.4);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (18, DATE '2018-06-13', 2, 68932.88);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (19, DATE '2018-06-26', 6, 46118.42);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (20, DATE '2018-08-14', 1, 92224.37);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (21, DATE '2017-09-13', 1, 16204.15);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (22, DATE '2017-09-29', 5, 73770.83);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (23, DATE '2017-09-23', 8, 84076.49);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (24, DATE '2018-06-27', 1, 51793.17);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (25, DATE '2018-08-17', 7, 7674.5);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (26, DATE '2017-11-10', 5, 42411.47);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (27, DATE '2018-06-04', 4, 98493.77);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (28, DATE '2018-08-02', 5, 87572.22);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (29, DATE '2018-02-08', 5, 71850.37);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (30, DATE '2018-08-05', 7, 47476.96);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (31, DATE '2018-07-31', 7, 32158.36);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (32, DATE '2018-07-18', 6, 4568.84);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (33, DATE '2018-07-17', 8, 92295.64);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (34, DATE '2017-11-16', 4, 74065.33);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (35, DATE '2017-10-22', 1, 79998.14);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (36, DATE '2017-12-18', 4, 26031.98);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (37, DATE '2017-08-27', 5, 34097.01);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (38, DATE '2018-06-09', 5, 25973.73);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (39, DATE '2018-07-10', 6, 27021.08);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (40, DATE '2018-06-22', 8, 97669.22);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (41, DATE '2018-03-01', 5, 97531.58);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (42, DATE '2018-05-29', 8, 32230.32);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (43, DATE '2018-06-06', 5, 7182.59);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (44, DATE '2018-06-01', 3, 23913.3);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (45, DATE '2017-10-27', 10, 34779.8);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (46, DATE '2018-06-07', 1, 3247.14);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (47, DATE '2018-04-29', 9, 3558.9);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (48, DATE '2018-04-21', 4, 43911.8);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (49, DATE '2018-05-02', 3, 58687.15);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (50, DATE '2017-11-10', 8, 30809.06);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (51, DATE '2018-08-21', 1, 34809.06);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (52, DATE '2018-08-21', 3, 10859.06);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (53, DATE '2018-08-21', 5, 80809.06);
insert into INVOICE (INVOICE_ID, INVOICE_DATE, CUSTOMER_ID, AMOUNT) values (54, DATE '2018-08-21', 7, 20809.06);

--GETS ITEMS THAT HAPPENED TODAY

SELECT * FROM INVOICE
WHERE INVOICE_DATE = TRUNC(CURRENT_DATE);

--GET NUMBER OF INVOICES PER CUSTOMER_ID

SELECT COUNT(INVOICE_ID), CUSTOMER_ID CUST_ID FROM INVOICE
GROUP BY CUSTOMER_ID
ORDER BY CUSTOMER_ID ASC;

--GET SUM OF INVOICES PER CUSTOMER_ID

SELECT SUM(AMOUNT) FROM INVOICE
GROUP BY CUSTOMER_ID
ORDER BY CUSTOMER_ID ASC;

--GETS PURCHASES WITHIN LAST MONTH DISPLAY DESC ORDER
SELECT * FROM INVOICE
WHERE INVOICE_DATE >= '21-JUL-2018'
ORDER BY AMOUNT DESC;

--GETS TOP 3

SELECT * FROM INVOICE
ORDER BY AMOUNT DESC
FETCH NEXT 3 ROWS ONLY;